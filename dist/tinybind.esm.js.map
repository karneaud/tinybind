{"version":3,"file":"tinybind.esm.js","sources":["../src/constants.js","../src/parsers.js","../src/tinybind.js","../src/observer.js","../src/bindings.js","../src/view.js","../src/adapter.js","../src/binders.js","../src/formatters.js","../src/component.js","../src/export.js"],"sourcesContent":["export const OPTIONS = [\n  'prefix',\n  'templateDelimiters',\n  'rootInterface',\n  'preloadData',\n  'handler'\n]\n\nexport const EXTENSIONS = [\n  'binders',\n  'formatters',\n  'adapters'\n]","const PRIMITIVE = 0\nconst KEYPATH = 1\nconst TEXT = 0\nconst BINDING = 1\n\nconst QUOTED_STR = /^'.*'$|^\".*\"$/\n\n// Parser and tokenizer for getting the type and value from a string.\nexport function parseType(string) {\n  let type = PRIMITIVE\n  let value = string\n\n  if (QUOTED_STR.test(string)) {\n    value = string.slice(1, -1)\n  } else if (string === 'true') {\n    value = true\n  } else if (string === 'false') {\n    value = false\n  } else if (string === 'null') {\n    value = null\n  } else if (string === 'undefined') {\n    value = undefined\n  } else if (!isNaN(string)) {\n    value = Number(string)\n  } else {\n    type = KEYPATH\n  }\n\n  return {type: type, value: value}\n}\n\n// Template parser and tokenizer for mustache-style text content bindings.\n// Parses the template and returns a set of tokens, separating static portions\n// of text from binding declarations.\nexport function parseTemplate(template, delimiters) {\n  var tokens\n  let length = template.length\n  let index = 0\n  let lastIndex = 0\n  let open = delimiters[0], close = delimiters[1]\n\n  while (lastIndex < length) {\n    index = template.indexOf(open, lastIndex)\n\n    if (index < 0) {\n      if (tokens) {\n        tokens.push({\n          type: TEXT,\n          value: template.slice(lastIndex)\n        })\n      }\n\n      break\n    } else {\n      tokens || (tokens = [])\n      if (index > 0 && lastIndex < index) {\n        tokens.push({\n          type: TEXT,\n          value: template.slice(lastIndex, index)\n        })\n      }\n\n      lastIndex = index + open.length\n      index = template.indexOf(close, lastIndex)\n\n      if (index < 0) {\n        let substring = template.slice(lastIndex - close.length)\n        let lastToken = tokens[tokens.length - 1]\n\n        if (lastToken && lastToken.type === TEXT) {\n          lastToken.value += substring\n        } else {\n          tokens.push({\n            type: TEXT,\n            value: substring\n          })\n        }\n\n        break\n      }\n\n      let value = template.slice(lastIndex, index).trim()\n\n      tokens.push({\n        type: BINDING,\n        value: value\n      })\n\n      lastIndex = index + close.length\n    }\n  }\n\n  return tokens\n}\n","import {EXTENSIONS} from './constants'\nimport {parseTemplate, parseType} from './parsers'\n\nconst tinybind = {\n  // Global binders.\n  binders: {},\n\n  // Global formatters.\n  formatters: {},\n\n  // Global sightglass adapters.\n  adapters: {},\n\n  // Default attribute prefix.\n  _prefix: 'rv',\n\n  _fullPrefix: 'rv-',\n\n  get prefix () {\n    return this._prefix\n  },\n\n  set prefix (value) {\n    this._prefix = value\n    this._fullPrefix = value + '-'\n  },\n\n  parseTemplate: parseTemplate,\n\n  parseType: parseType,\n\n  // Default template delimiters.\n  templateDelimiters: ['{', '}'],\n\n  // Default sightglass root interface.\n  rootInterface: '.',\n\n  // Preload data by default.\n  preloadData: true,\n\n  // Default event handler.\n  handler: function(context, ev, binding) {\n    this.call(context, ev, binding.view.models)\n  },\n\n  // Sets the attribute on the element. If no binder above is matched it will fall\n  // back to using this binder.\n  fallbackBinder: function(el, value) {\n    if (value != null) {\n      el.setAttribute(this.type, value)\n    } else {\n      el.removeAttribute(this.type)\n    }  \n  },\n\n  // Merges an object literal into the corresponding global options.\n  configure: function(options) {\n    if (!options) {\n      return\n    }\n    Object.keys(options).forEach(option => {\n      let value = options[option]\n\n      if (EXTENSIONS.indexOf(option) > -1) {\n        Object.keys(value).forEach(key => {\n          this[option][key] = value[key]\n        })\n      } else {\n        this[option] = value\n      }\n    })\n  }\n}\n\nexport default tinybind\n","\n// Check if a value is an object than can be observed.\nfunction isObject(obj) {\n  return typeof obj === 'object' && obj !== null\n}\n\n// Error thrower.\nfunction error(message) {\n  throw new Error(`[Observer] ${message}`)\n}\n\nlet adapters;\nlet interfaces;\nlet rootInterface;\n\n// Constructs a new keypath observer and kicks things off.\nclass Observer {\n  static updateOptions (options) {\n    adapters = options.adapters\n    interfaces = Object.keys(adapters)\n    rootInterface = options.rootInterface\n  }\n  \n  // Tokenizes the provided keypath string into interface + path tokens for the\n  // observer to work with.\n  static tokenize (keypath, root) {\n    const tokens = [];\n    let current = {i: root, path: ''};\n    let index;\n    let chr;\n  \n    for (index = 0; index < keypath.length; index++) {\n      chr = keypath.charAt(index)\n  \n      if (!!~interfaces.indexOf(chr)) {\n        tokens.push(current)\n        current = {i: chr, path: ''}\n      } else {\n        current.path += chr\n      }\n    }\n  \n    tokens.push(current)\n    return tokens\n  }\n\n  constructor(obj, keypath, callback) {\n    this.keypath = keypath\n    this.callback = callback\n    this.objectPath = []\n    this.parse()\n    this.obj = this.getRootObject(obj)\n\n    if (isObject(this.target = this.realize())) {\n      this.set(true, this.key, this.target, this.callback)\n    }\n  }\n\n  // Parses the keypath using the interfaces defined on the view. Sets variables\n  // for the tokenized keypath as well as the end key.\n  parse() {\n    let path;\n    let root;\n\n    if (!interfaces.length) {\n      error('Must define at least one adapter interface.')\n    }\n\n    if (!!~interfaces.indexOf(this.keypath[0])) {\n      root = this.keypath[0]\n      path = this.keypath.substr(1)\n    } else {\n      root = rootInterface\n      path = this.keypath\n    }\n\n    this.tokens = Observer.tokenize(path, root)\n    this.key = this.tokens.pop()\n  }\n\n  // Realizes the full keypath, attaching observers for every key and correcting\n  // old observers to any changed objects in the keypath.\n  realize() {\n    let current = this.obj;\n    let unreached = -1;\n    let prev;\n    let token;\n\n    for (let index = 0; index < this.tokens.length; index++) {\n      token = this.tokens[index]\n      if (isObject(current)) {\n        if (typeof this.objectPath[index] !== 'undefined') {\n          if (current !== (prev = this.objectPath[index])) {\n            this.set(false, token, prev, this)\n            this.set(true, token, current, this)\n            this.objectPath[index] = current\n          }\n        } else {\n          this.set(true, token, current, this)\n          this.objectPath[index] = current\n        }\n\n        current = this.get(token, current)\n      } else {\n        if (unreached === -1) {\n          unreached = index\n        }\n\n        if (prev = this.objectPath[index]) {\n          this.set(false, token, prev, this)\n        }\n      }\n    }\n\n    if (unreached !== -1) {\n      this.objectPath.splice(unreached)\n    }\n\n    return current\n  }\n\n  // Updates the keypath. This is called when any intermediary key is changed.\n  sync() {\n    let next;\n    let oldValue;\n    let newValue;\n\n    if ((next = this.realize()) !== this.target) {\n      if (isObject(this.target)) {\n        this.set(false, this.key, this.target, this.callback)\n      }\n\n      if (isObject(next)) {\n        this.set(true, this.key, next, this.callback)\n      }\n\n      oldValue = this.value()\n      this.target = next\n      newValue = this.value()\n      if (newValue !== oldValue || newValue instanceof Function) this.callback.sync()\n    } else if (next instanceof Array) {\n      this.callback.sync()\n    }\n  }\n\n  // Reads the current end value of the observed keypath. Returns undefined if\n  // the full keypath is unreachable.\n  value() {\n    if (isObject(this.target)) {\n      return this.get(this.key, this.target)\n    }\n  }\n\n  // Sets the current end value of the observed keypath. Calling setValue when\n  // the full keypath is unreachable is a no-op.\n  setValue(value) {\n    if (isObject(this.target)) {\n      adapters[this.key.i].set(this.target, this.key.path, value)\n    }\n  }\n\n  // Gets the provided key on an object.\n  get(key, obj) {\n    return adapters[key.i].get(obj, key.path);\n  }\n\n  // Observes or unobserves a callback on the object using the provided key.\n  set(active, key, obj, callback) {\n    const action = active ? 'observe' : 'unobserve';\n    adapters[key.i][action](obj, key.path, callback)\n  }\n\n  // Unobserves the entire keypath.\n  unobserve() {\n    let obj;\n    let token;\n\n    for (let index = 0; index < this.tokens.length; index++) {\n      token = this.tokens[index]\n      if (obj = this.objectPath[index]) {\n        this.set(false, token, obj, this)\n      }\n    }\n\n    if (isObject(this.target)) {\n      this.set(false, this.key, this.target, this.callback)\n    }\n  }\n\n  // traverse the scope chain to find the scope which has the root property\n  // if the property is not found in chain, returns the root scope\n  getRootObject(obj) {\n    let rootProp;\n    let current;\n    if (!obj.$parent) {\n      return obj;\n    }\n\n    if (this.tokens.length) {\n      rootProp = this.tokens[0].path\n    } else {\n      rootProp = this.key.path\n    }\n\n    current = obj;\n    while (current.$parent && (current[rootProp] === undefined)) {\n      current = current.$parent\n    }\n\n    return current;\n  }\n}\n\nexport default Observer\n","import { parseType } from './parsers'\nimport Observer from './observer'\n\nfunction getInputValue(el) {\n  if (el.type === 'checkbox') {\n    return el.checked\n  } else if (el.type === 'select-multiple') {\n    const results = []\n    let option\n    for (let i = 0; i < el.options.length; i++) {\n      option = el.options[i]\n      if (option.selected) {\n        results.push(option.value);\n      }\n    }\n    return results\n  } else {\n    return el.value\n  }\n}\n\nconst FORMATTER_ARGS = /[^\\s']+|'([^']|'[^\\s])*'|\"([^\"]|\"[^\\s])*\"/g\nconst FORMATTER_SPLIT = /\\s+/\n\n// A single binding between a model attribute and a DOM element.\nexport class Binding {\n  // All information about the binding is passed into the constructor; the\n  // containing view, the DOM node, the type of binding, the model object and the\n  // keypath at which to listen for changes.\n  constructor(view, el, type, keypath, binder, arg, formatters) {\n    this.view = view\n    this.el = el\n    this.type = type\n    this.keypath = keypath\n    this.binder = binder\n    this.arg = arg\n    this.formatters = formatters\n    this.formatterObservers = {}\n    this.model = undefined\n  }\n\n  // Observes the object keypath\n  observe(obj, keypath) {\n    return new Observer(obj, keypath, this)\n  }\n\n  parseTarget() {\n    if (this.keypath) {\n      let token = parseType(this.keypath)\n      if (token.type === 0) {\n        this.value = token.value\n      } else {\n        this.observer = this.observe(this.view.models, this.keypath)\n        this.model = this.observer.target\n      }\n    } else {\n      this.value = undefined;\n    }\n  }\n\n  parseFormatterArguments(args, formatterIndex) {\n    return args\n      .map(parseType)\n      .map(({ type, value }, ai) => {\n        if (type === 0) {\n          return value\n        } else {\n          if (!this.formatterObservers[formatterIndex]) {\n            this.formatterObservers[formatterIndex] = {}\n          }\n\n          let observer = this.formatterObservers[formatterIndex][ai]\n\n          if (!observer) {\n            observer = this.observe(this.view.models, value)\n            this.formatterObservers[formatterIndex][ai] = observer\n          }\n\n          return observer.value()\n        }\n      })\n  }\n\n  // Applies all the current formatters to the supplied value and returns the\n  // formatted value.\n  formattedValue(value) {\n    return this.formatters.reduce((result, declaration, index) => {\n      let args = declaration.match(FORMATTER_ARGS)\n      let id = args.shift()\n      let formatter = this.view.options.formatters[id]\n\n      const processedArgs = this.parseFormatterArguments(args, index)\n\n      if (formatter && (formatter.read instanceof Function)) {\n        result = formatter.read(result, ...processedArgs)\n      } else if (formatter instanceof Function) {\n        result = formatter(result, ...processedArgs)\n      }\n      return result\n    }, value)\n  }\n\n  // Returns an event handler for the binding around the supplied function.\n  eventHandler(fn) {\n    let binding = this\n    let handler = binding.view.options.handler\n\n    return function (ev) {\n      handler.call(fn, this, ev, binding)\n    }\n  }\n\n  // Sets the value for the binding. This Basically just runs the binding routine\n  // with the supplied value formatted.\n  set(value) {\n    if ((value instanceof Function) && !this.binder.function) {\n      value = this.formattedValue(value.call(this.model))\n    } else {\n      value = this.formattedValue(value)\n    }\n\n    let routineFn = this.binder.routine || this.binder\n\n    if (routineFn instanceof Function) {\n      routineFn.call(this, this.el, value)\n    }\n  }\n\n  // Syncs up the view binding with the model.\n  sync() {\n    if (this.observer) {\n      this.model = this.observer.target\n      this.set(this.observer.value())\n    } else {\n      this.set(this.value)\n    }\n  }\n\n  // Publishes the value currently set on the input element back to the model.\n  publish() {\n    if (this.observer) {\n      var value = this.formatters.reduceRight((result, declaration, index) => {\n        const args = declaration.split(FORMATTER_SPLIT)\n        const id = args.shift()\n        const formatter = this.view.options.formatters[id]\n        const processedArgs = this.parseFormatterArguments(args, index)\n\n        if (formatter && formatter.publish) {\n          result = formatter.publish(result, ...processedArgs)\n        }\n        return result\n      }, this.getValue(this.el))\n      this.observer.setValue(value)\n    }\n  }\n\n  // Subscribes to the model for changes at the specified keypath. Bi-directional\n  // routines will also listen for changes on the element to propagate them back\n  // to the model.\n  bind() {\n    this.parseTarget()\n\n    if (this.binder.hasOwnProperty('bind')) {\n      this.binder.bind.call(this, this.el)\n    }\n\n    if (this.view.options.preloadData) {\n      this.sync()\n    }\n  }\n\n  // Unsubscribes from the model and the element.\n  unbind() {\n    if (this.binder.unbind) {\n      this.binder.unbind.call(this, this.el)\n    }\n\n    if (this.observer) {\n      this.observer.unobserve()\n    }\n\n    Object.keys(this.formatterObservers).forEach(fi => {\n      let args = this.formatterObservers[fi]\n\n      Object.keys(args).forEach(ai => {\n        args[ai].unobserve()\n      })\n    })\n\n    this.formatterObservers = {}\n  }\n\n  // Updates the binding's model from what is currently set on the view. Unbinds\n  // the old model first and then re-binds with the new model.\n  update(models = {}) {\n    if (this.observer) {\n      this.model = this.observer.target\n    }\n\n    if (this.binder.update) {\n      this.binder.update.call(this, models)\n    }\n  }\n\n  // Returns elements value\n  getValue(el) {\n    if (this.binder && this.binder.getValue) {\n      return this.binder.getValue.call(this, el)\n    } else {\n      return getInputValue(el)\n    }\n  }\n}\n","import tinybind from './tinybind'\nimport {Binding} from './bindings'\nimport {parseTemplate} from './parsers'\n\nconst textBinder = {\n  routine: (node, value) => {\n    node.data = (value != null) ? value : ''\n  }\n}\n\nconst DECLARATION_SPLIT = /((?:'[^']*')*(?:(?:[^\\|']*(?:'[^']*')+[^\\|']*)+|[^\\|]+))|^$/g\n\nconst parseNode = (view, node) => {\n  let block = false\n\n  if (node.nodeType === 3) {\n    let tokens = parseTemplate(node.data, tinybind.templateDelimiters)\n\n    if (tokens) {\n      for (let i = 0; i < tokens.length; i++) {\n        let token = tokens[i]\n        let text = document.createTextNode(token.value)\n        node.parentNode.insertBefore(text, node)\n\n        if (token.type === 1) {\n          view.buildBinding(text, null, token.value, textBinder, null)\n        }\n      }\n\n      node.parentNode.removeChild(node)\n    }\n    block = true\n  } else if (node.nodeType === 1) {\n    block = view.traverse(node)\n  }\n\n  if (!block) {\n    for (let i = 0; i < node.childNodes.length; i++) {\n      parseNode(view, node.childNodes[i]);\n    }\n  }\n}\n\nconst bindingComparator = (a, b) => {\n  let aPriority = a.binder ? (a.binder.priority || 0) : 0\n  let bPriority = b.binder ? (b.binder.priority || 0) : 0\n  return bPriority - aPriority\n}\n\nconst trimStr = (str) => {\n  return str.trim()\n}\n\n// A collection of bindings built from a set of parent nodes.\nexport default class View {\n  // The DOM elements and the model objects for binding are passed into the\n  // constructor along with any local options that should be used throughout the\n  // context of the view and it's bindings.\n  constructor(els, models, options) {\n    if (els.jquery || els instanceof Array) {\n      this.els = els\n    } else {\n      this.els = [els]\n    }\n\n    this.models = models\n    this.options = options\n\n    this.build()\n  }\n\n\n  buildBinding(node, type, declaration, binder, arg) {\n    let pipes = declaration.match(DECLARATION_SPLIT).map(trimStr)\n\n    let keypath = pipes.shift()\n\n    this.bindings.push(new Binding(this, node, type, keypath, binder, arg, pipes))\n  }\n\n  // Parses the DOM tree and builds `Binding` instances for every matched\n  // binding declaration.\n  build() {\n    this.bindings = []\n\n    let elements = this.els, i, len;\n    for (i = 0, len = elements.length; i < len; i++) {\n      parseNode(this, elements[i])\n    }\n\n    this.bindings.sort(bindingComparator)\n  }\n\n  traverse(node) {\n    let bindingPrefix = tinybind._fullPrefix\n    let block = node.nodeName === 'SCRIPT' || node.nodeName === 'STYLE'\n    let attributes = node.attributes\n    let bindInfos = []\n    let starBinders = this.options.starBinders\n    var type, binder, identifier, arg\n\n\n    for (let i = 0, len = attributes.length; i < len; i++) {\n      let attribute = attributes[i]\n      if (attribute.name.indexOf(bindingPrefix) === 0) {\n        type = attribute.name.slice(bindingPrefix.length)\n        binder = this.options.binders[type]\n        arg = undefined\n\n        if (!binder) {\n          for (let k = 0; k < starBinders.length; k++) {\n            identifier = starBinders[k]\n            if (type.slice(0, identifier.length - 1) === identifier.slice(0, -1)) {\n              binder = this.options.binders[identifier]\n              arg = type.slice(identifier.length - 1)\n              break\n            }\n          }\n        }\n\n        if (!binder) {\n          binder = tinybind.fallbackBinder\n        }\n\n        if (binder.block) {\n          this.buildBinding(node, type, attribute.value, binder, arg)\n          node.removeAttribute(attribute.name)\n          return true;\n        }\n\n        bindInfos.push({attr: attribute, binder: binder, type: type, arg: arg})\n      }\n    }\n\n    for (let i = 0; i < bindInfos.length; i++) {\n      let bindInfo = bindInfos[i]\n      this.buildBinding(node, bindInfo.type, bindInfo.attr.value, bindInfo.binder, bindInfo.arg)\n      node.removeAttribute(bindInfo.attr.name)\n    }\n\n    return block\n  }\n\n  // Binds all of the current bindings for this view.\n  bind() {\n    this.bindings.forEach(binding => {\n      binding.bind()\n    })\n  }\n\n  // Unbinds all of the current bindings for this view.\n  unbind() {\n    this.bindings.forEach(binding => {\n      binding.unbind()\n    })\n  }\n\n  // Syncs up the view with the model by running the routines on all bindings.\n  sync() {\n    this.bindings.forEach(binding => {\n      binding.sync()\n    })\n  }\n\n  // Publishes the input values from the view back to the model (reverse sync).\n  publish() {\n    this.bindings.forEach(binding => {\n      if (binding.binder && binding.binder.publishes) {\n        binding.publish()\n      }\n    })\n  }\n\n  // Updates the view's models along with any affected bindings.\n  update(models = {}) {\n    Object.keys(models).forEach(key => {\n      this.models[key] = models[key]\n    })\n\n    this.bindings.forEach(binding => {\n      if (binding.update) {\n        binding.update(models)\n      }\n    })\n  }\n}\n","// The default `.` adapter that comes with tinybind.js. Allows subscribing to\n// properties on plain objects, implemented in ES5 natives using\n// `Object.defineProperty`.\n\nconst ARRAY_METHODS = [\n  'push',\n  'pop',\n  'shift',\n  'unshift',\n  'sort',\n  'reverse',\n  'splice'\n]\n\nconst adapter = {\n  counter: 0,\n  weakmap: {},\n\n  weakReference: function(obj) {\n    if (!obj.hasOwnProperty('__rv')) {\n      let id = this.counter++\n\n      Object.defineProperty(obj, '__rv', {\n        value: id\n      })\n    }\n\n    if (!this.weakmap[obj.__rv]) {\n      this.weakmap[obj.__rv] = {\n        callbacks: {}\n      }\n    }\n\n    return this.weakmap[obj.__rv]\n  },\n\n  cleanupWeakReference: function(data, refId) {\n    if (!Object.keys(data.callbacks).length) {\n      if (!(data.pointers && Object.keys(data.pointers).length)) {\n        delete this.weakmap[refId]\n      }\n    }\n  },\n\n  stubFunction: function(obj, fn) {\n    const original = obj[fn]\n    const data = this.weakReference(obj)\n    const weakmap = this.weakmap\n\n    obj[fn] = (...args) => {\n      let response = original.apply(obj, args)\n\n      Object.keys(data.pointers).forEach(refId => {\n        let k = data.pointers[refId]\n\n        if (weakmap[refId]) {\n          if (weakmap[refId].callbacks[k] instanceof Array) {\n            weakmap[refId].callbacks[k].forEach(callback => {\n              callback.sync()\n            })\n          }\n        }\n      })\n\n      return response\n    }\n  },\n\n  observeArray: function(value, refId, keypath) {\n    if (value instanceof Array) {\n      let data = this.weakReference(value)\n\n      if (!data.pointers) {\n        data.pointers = {}\n\n        ARRAY_METHODS.forEach(fn => {\n          this.stubFunction(value, fn)\n        })\n      }\n\n      if (!data.pointers[refId]) {\n        data.pointers[refId] = []\n      }\n\n      if (data.pointers[refId].indexOf(keypath) === -1) {\n        data.pointers[refId].push(keypath)\n      }\n    }\n  },\n\n  unobserveArray: function(value, refId, keypath) {\n    if ((value instanceof Array) && (value.__rv != null)) {\n      let data = this.weakmap[value.__rv]\n\n      if (data) {\n        let pointers = data.pointers[refId]\n\n        if (pointers) {\n          let idx = pointers.indexOf(keypath)\n\n          if (idx > -1) {\n            pointers.splice(idx, 1)\n          }\n\n          if (!pointers.length) {\n            delete data.pointers[refId]\n          }\n\n          this.cleanupWeakReference(data, value.__rv)\n        }\n      }\n    }\n  },\n\n  observe: function(obj, keypath, callback) {\n    let value    \n    const callbacks = this.weakReference(obj).callbacks\n\n    if (!callbacks[keypath]) {\n      callbacks[keypath] = []\n      let desc = Object.getOwnPropertyDescriptor(obj, keypath)\n\n      if (!desc || !(desc.get || desc.set || !desc.configurable)) {\n        value = obj[keypath]\n\n        Object.defineProperty(obj, keypath, {\n          enumerable: true,\n\n          get: () => {\n            return value\n          },\n\n          set: newValue => {\n            if (newValue !== value) {\n              this.unobserveArray(value, obj.__rv, keypath)\n              value = newValue\n              const data = this.weakmap[obj.__rv]\n\n              if (data) {\n                let callbacks = data.callbacks[keypath]\n\n                if (callbacks) {\n                  callbacks.forEach(cb => {\n                      cb.sync()\n                  })\n                }\n\n                this.observeArray(newValue, obj.__rv, keypath)\n              }\n            }\n          }\n        })\n      }\n    }\n\n    if (callbacks[keypath].indexOf(callback) === -1) {\n      callbacks[keypath].push(callback)\n    }\n\n    this.observeArray(obj[keypath], obj.__rv, keypath)\n  },\n\n  unobserve: function(obj, keypath, callback) {\n    let data = this.weakmap[obj.__rv]\n\n    if (data) {\n      let callbacks = data.callbacks[keypath]\n\n      if (callbacks) {\n        let idx = callbacks.indexOf(callback)\n\n        if (idx > -1) {\n          callbacks.splice(idx, 1)\n\n          if (!callbacks.length) {\n            delete data.callbacks[keypath]\n            this.unobserveArray(obj[keypath], obj.__rv, keypath)\n          }\n        }\n\n        this.cleanupWeakReference(data, obj.__rv)\n      }\n    }\n  },\n\n  get: function(obj, keypath) {\n    return obj[keypath]\n  },\n\n  set: (obj, keypath, value) => {\n    obj[keypath] = value\n  }\n}\n\nexport default adapter\n","import View from './view'\n\nconst getString = (value) => {\n  return value != null ? value.toString() : undefined\n}\n\nconst times = (n, cb) => {\n  for (let i = 0; i < n; i++) cb()\n}\n\nfunction createView(binding, data, anchorEl) {\n  let template = binding.el.cloneNode(true)\n  let view = new View(template, data, binding.view.options)\n  view.bind()\n  binding.marker.parentNode.insertBefore(template, anchorEl)\n  return view\n}\n\nconst binders = {\n  // Binds an event handler on the element.\n  'on-*': {\n    function: true,\n    priority: 1000,\n\n    unbind: function(el) {\n      if (this.handler) {\n        el.removeEventListener(this.arg, this.handler)\n      }\n    },\n\n    routine: function(el, value) {\n      if (this.handler) {\n        el.removeEventListener(this.arg, this.handler)\n      }\n\n      this.handler = this.eventHandler(value)\n      el.addEventListener(this.arg, this.handler)\n    }\n  },\n\n  // Appends bound instances of the element in place for each item in the array.\n  'each-*': {\n    block: true,\n\n    priority: 4000,\n\n    bind: function(el) {\n      if (!this.marker) {\n        this.marker = document.createComment(` tinybind: ${this.type} `)\n        this.iterated = []\n\n        el.parentNode.insertBefore(this.marker, el)\n        el.parentNode.removeChild(el)\n      } else {\n        this.iterated.forEach(view => {\n          view.bind()\n        })\n      }\n    },\n\n    unbind: function(el) {\n      if (this.iterated) {\n        this.iterated.forEach(view => {\n          view.unbind()\n        })\n      }\n    },\n\n    routine: function(el, collection) {\n      let modelName = this.arg\n      collection = collection || []\n      let indexProp = el.getAttribute('index-property') || '$index'\n\n      collection.forEach((model, index) => {\n        let data = {$parent: this.view.models}\n        data[indexProp] = index\n        data[modelName] = model\n        let view = this.iterated[index]\n\n        if (!view) {\n\n          let previous = this.marker\n\n          if (this.iterated.length) {\n            previous = this.iterated[this.iterated.length - 1].els[0]\n          }\n\n          view = createView(this, data, previous.nextSibling)\n          this.iterated.push(view)\n        } else {\n          if (view.models[modelName] !== model) {\n            // search for a view that matches the model\n            let matchIndex, nextView\n            for (let nextIndex = index + 1; nextIndex < this.iterated.length; nextIndex++) {\n              nextView = this.iterated[nextIndex]\n              if (nextView.models[modelName] === model) {\n                matchIndex = nextIndex\n                break\n              }\n            }\n            if (matchIndex !== undefined) {\n              // model is in other position\n              // todo: consider avoiding the splice here by setting a flag\n              // profile performance before implementing such change\n              this.iterated.splice(matchIndex, 1)\n              this.marker.parentNode.insertBefore(nextView.els[0], view.els[0])\n              nextView.models[indexProp] = index\n            } else {\n              //new model\n              nextView = createView(this, data, view.els[0])\n            }\n            this.iterated.splice(index, 0, nextView)\n          } else {\n            view.models[indexProp] = index\n          }\n        }\n      })\n\n      if (this.iterated.length > collection.length) {\n        times(this.iterated.length - collection.length, () => {\n          let view = this.iterated.pop()\n          view.unbind()\n          this.marker.parentNode.removeChild(view.els[0])\n        })\n      }\n\n      if (el.nodeName === 'OPTION') {\n        this.view.bindings.forEach(binding => {\n          if (binding.el === this.marker.parentNode && binding.type === 'value') {\n            binding.sync()\n          }\n        })\n      }\n    },\n\n    update: function(models) {\n      let data = {}\n\n      //todo: add test and fix if necessary\n\n      Object.keys(models).forEach(key => {\n        if (key !== this.arg) {\n          data[key] = models[key]\n        }\n      })\n\n      this.iterated.forEach(view => {\n        view.update(data)\n      })\n    }\n  },\n\n  // Adds or removes the class from the element when value is true or false.\n  'class-*': function(el, value) {\n    let elClass = ` ${el.className} `\n\n    if (!value === (elClass.indexOf(` ${this.arg} `) > -1)) {\n      if (value) {\n        el.className = `${el.className} ${this.arg}`\n      } else {\n        el.className = elClass.replace(` ${this.arg} `, ' ').trim()\n      }\n    }\n  },\n\n  // Sets the element's text value.\n  text: (el, value) => {\n    el.textContent = value != null ? value : ''\n  },\n\n  // Sets the element's HTML content.\n  html: (el, value) => {\n    el.innerHTML = value != null ? value : ''\n  },\n\n  // Shows the element when value is true.\n  show: (el, value) => {\n    el.style.display = value ? '' : 'none'\n  },\n\n  // Hides the element when value is true (negated version of `show` binder).\n  hide: (el, value) => {\n    el.style.display = value ? 'none' : ''\n  },\n\n  // Enables the element when value is true.\n  enabled: (el, value) => {\n    el.disabled = !value\n  },\n\n  // Disables the element when value is true (negated version of `enabled` binder).\n  disabled: (el, value) => {\n    el.disabled = !!value\n  },\n\n  // Checks a checkbox or radio input when the value is true. Also sets the model\n  // property when the input is checked or unchecked (two-way binder).\n  checked: {\n    publishes: true,\n    priority: 2000,\n\n    bind: function(el) {\n      var self = this;\n      if (!this.callback) {\n        this.callback = function () {\n          self.publish();\n        }\n      }\n      el.addEventListener('change', this.callback)\n    }, \n\n    unbind: function(el) {\n      el.removeEventListener('change', this.callback)\n    },\n\n    routine: function(el, value) {\n      if (el.type === 'radio') {\n        el.checked = getString(el.value) === getString(value)\n      } else {\n        el.checked = !!value\n      }\n    }\n  },\n\n  // Sets the element's value. Also sets the model property when the input changes\n  // (two-way binder).\n  value: {\n    publishes: true,\n    priority: 3000,\n\n    bind: function(el) {\n      this.isRadio = el.tagName === 'INPUT' && (el.type === 'radio' || el.type === 'checkbox');\n      if (!this.isRadio) {\n        this.event = el.getAttribute('event-name') || (el.tagName === 'SELECT' ? 'change' : 'input')\n\n        var self = this;\n        if (!this.callback) {\n          this.callback = function () {\n            self.publish();\n          }\n        }\n        el.addEventListener(this.event, this.callback)\n      }\n    },\n\n    unbind: function(el) {\n      if (!this.isRadio) {\n        el.removeEventListener(this.event, this.callback)\n      }\n    },\n\n    routine: function(el, value) {\n      if (this.isRadio) {\n        el.setAttribute('value', value)\n      } else {\n        if (el.type === 'select-multiple') {\n          if (value instanceof Array) {\n            for (let i = 0; i < el.length; i++) {\n              let option = el[i];\n              option.selected = value.indexOf(option.value) > -1\n            }\n          }\n        } else if (getString(value) !== getString(el.value)) {\n          el.value = value != null ? value : ''\n        }\n      }\n    }\n  },\n\n  // Inserts and binds the element and it's child nodes into the DOM when true.\n  if: {\n    block: true,\n    priority: 4000,\n\n    bind: function(el) {\n      if (!this.marker) {\n        this.marker = document.createComment(' tinybind: ' + this.type + ' ' + this.keypath + ' ');\n        this.attached = false\n\n        el.parentNode.insertBefore(this.marker, el)\n        el.parentNode.removeChild(el)\n      } else if (this.bound === false && this.nested) {\n        this.nested.bind()\n      }\n      this.bound = true\n    },\n\n    unbind: function() {\n      if (this.nested) {\n        this.nested.unbind()\n        this.bound = false\n      }\n    },\n\n    routine: function(el, value) {\n      if (!!value !== this.attached) {\n        if (value) {\n\n          if (!this.nested) {\n            this.nested = new View(el, this.view.models, this.view.options)\n            this.nested.bind()\n          }\n\n          this.marker.parentNode.insertBefore(el, this.marker.nextSibling)\n          this.attached = true\n        } else {\n          el.parentNode.removeChild(el)\n          this.attached = false\n        }\n      }\n    },\n\n    update: function(models) {\n      if (this.nested) {\n        this.nested.update(models)\n      }\n    }\n  }\n}\n\nexport default binders\n","const formatters = {\n  watch: function(value) {\n    return value;\n  },\n\n  not: function(value) {\n    return !value;\n  },\n\n  negate: function(value) {\n    return !value;\n  }\n}\n\nexport default formatters","\nimport tinybind from './tinybind'\n\nclass Component extends HTMLElement {\n  static get observedAttributes() {\n    const template = this.template\n    if (!template) {\n      throw new Error(`No template declared for ${this.name}`)\n    }\n\n    this.__templateEl = document.createElement('template')\n    this.__templateEl.innerHTML = template\n    \n    const propAttributeMap = this.__propAttributeMap = {}\n    const attributes = []\n    const properties = this.properties\n    if (properties) {\n      Object.keys(properties).forEach(propName => {\n        const propConfig = properties[propName]\n        const attrName = typeof propConfig === 'string' ? propConfig : propName\n        propAttributeMap[attrName] = propName\n        attributes.push(attrName)\n      })\n    }    \n    return attributes\n  }\n\n  connectedCallback() {\n    const nodes = this.constructor.__templateEl.content.cloneNode(true)\n    this.__tinybindView = tinybind.bind(nodes, this)    \n    while (this.firstChild) {\n      this.removeChild(this.firstChild);\n    }\n    this.appendChild(nodes)\n  }\n\n  disconnectedCallback() {\n    this.__tinybindView.unbind()    \n  }\n\n  attributeChangedCallback(name, old, value) {\n    if (old !== value) {      \n      const propName = this.constructor.__propAttributeMap[name]\n      this[propName] = value\n    }\n  }  \n}\n\nexport default Component","import tinybind from './tinybind'\nimport View from './view'\nimport {OPTIONS, EXTENSIONS} from './constants'\nimport adapter from './adapter'\nimport binders from './binders'\nimport formatters from './formatters'\nimport Observer from './observer'\nimport Component from './component'\n\n// Returns the public interface.\n\ntinybind.binders = binders\ntinybind.formatters = formatters\ntinybind.adapters['.'] = adapter\ntinybind.Component = Component\n\n// Binds some data to a template / element. Returns a tinybind.View instance.\ntinybind.bind = (el, models, options) => {\n  let viewOptions = {}\n  models = models || {}\n  options = options || {}\n\n  EXTENSIONS.forEach(extensionType => {\n    viewOptions[extensionType] = Object.create(null)\n\n    if (options[extensionType]) {\n      Object.keys(options[extensionType]).forEach(key => {\n        viewOptions[extensionType][key] = options[extensionType][key]\n      })\n    }\n\n    Object.keys(tinybind[extensionType]).forEach(key => {\n      if (!viewOptions[extensionType][key]) {\n        viewOptions[extensionType][key] = tinybind[extensionType][key]\n      }\n    })\n  })\n\n  OPTIONS.forEach(option => {\n    let value = options[option]\n    viewOptions[option] = value != null ? value : tinybind[option]\n  })\n\n  viewOptions.starBinders = Object.keys(viewOptions.binders).filter(function (key) {\n    return key.indexOf('*') > 0\n  })\n\n  Observer.updateOptions(viewOptions)\n\n  let view = new View(el, models, viewOptions)\n  view.bind()\n  return view\n}\n\nexport default tinybind\n"],"names":["OPTIONS","EXTENSIONS","PRIMITIVE","KEYPATH","TEXT","BINDING","QUOTED_STR","parseType","string","type","value","test","slice","undefined","isNaN","Number","parseTemplate","template","delimiters","tokens","length","index","lastIndex","open","close","indexOf","push","substring","lastToken","trim","tinybind","binders","formatters","adapters","_prefix","_fullPrefix","prefix","templateDelimiters","rootInterface","preloadData","handler","context","ev","binding","call","view","models","fallbackBinder","el","setAttribute","removeAttribute","configure","options","Object","keys","forEach","option","key","isObject","obj","error","message","Error","interfaces","Observer","updateOptions","tokenize","keypath","root","current","i","path","chr","charAt","callback","objectPath","parse","getRootObject","target","realize","set","substr","pop","unreached","prev","token","get","splice","sync","next","oldValue","newValue","Function","Array","setValue","active","action","unobserve","rootProp","$parent","getInputValue","checked","results","selected","FORMATTER_ARGS","FORMATTER_SPLIT","Binding","binder","arg","formatterObservers","model","observe","parseTarget","observer","parseFormatterArguments","args","formatterIndex","map","ai","formattedValue","reduce","result","declaration","match","id","shift","formatter","processedArgs","read","eventHandler","fn","function","routineFn","routine","publish","reduceRight","split","getValue","bind","hasOwnProperty","unbind","fi","update","textBinder","node","data","DECLARATION_SPLIT","parseNode","block","nodeType","text","document","createTextNode","parentNode","insertBefore","buildBinding","removeChild","traverse","childNodes","bindingComparator","a","b","aPriority","priority","bPriority","trimStr","str","View","els","jquery","build","pipes","bindings","elements","len","sort","bindingPrefix","nodeName","attributes","bindInfos","starBinders","identifier","attribute","name","k","attr","bindInfo","publishes","ARRAY_METHODS","adapter","counter","weakmap","weakReference","defineProperty","__rv","callbacks","cleanupWeakReference","refId","pointers","stubFunction","original","response","apply","observeArray","unobserveArray","idx","desc","getOwnPropertyDescriptor","configurable","enumerable","cb","getString","toString","times","n","createView","anchorEl","cloneNode","marker","removeEventListener","addEventListener","createComment","iterated","collection","modelName","indexProp","getAttribute","previous","nextSibling","matchIndex","nextView","nextIndex","elClass","className","replace","textContent","html","innerHTML","show","style","display","hide","enabled","disabled","self","isRadio","tagName","event","if","attached","bound","nested","watch","not","negate","Component","connectedCallback","nodes","constructor","__templateEl","content","__tinybindView","firstChild","appendChild","disconnectedCallback","attributeChangedCallback","old","propName","__propAttributeMap","createElement","propAttributeMap","properties","propConfig","attrName","HTMLElement","viewOptions","extensionType","create","filter"],"mappings":"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"}