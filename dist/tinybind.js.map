{"version":3,"file":"tinybind.js","sources":["../src/constants.js","../src/parsers.js","../src/tinybind.js","../src/observer.js","../src/bindings.js","../src/view.js","../src/adapter.js","../src/binders.js","../src/formatters.js","../src/component.js","../src/export.js"],"sourcesContent":["export const OPTIONS = [\n  'prefix',\n  'templateDelimiters',\n  'rootInterface',\n  'preloadData',\n  'handler'\n]\n\nexport const EXTENSIONS = [\n  'binders',\n  'formatters',\n  'adapters'\n]","const PRIMITIVE = 0\nconst KEYPATH = 1\nconst TEXT = 0\nconst BINDING = 1\n\nconst QUOTED_STR = /^'.*'$|^\".*\"$/\n\n// Parser and tokenizer for getting the type and value from a string.\nexport function parseType(string) {\n  let type = PRIMITIVE\n  let value = string\n\n  if (QUOTED_STR.test(string)) {\n    value = string.slice(1, -1)\n  } else if (string === 'true') {\n    value = true\n  } else if (string === 'false') {\n    value = false\n  } else if (string === 'null') {\n    value = null\n  } else if (string === 'undefined') {\n    value = undefined\n  } else if (!isNaN(string)) {\n    value = Number(string)\n  } else {\n    type = KEYPATH\n  }\n\n  return {type: type, value: value}\n}\n\n// Template parser and tokenizer for mustache-style text content bindings.\n// Parses the template and returns a set of tokens, separating static portions\n// of text from binding declarations.\nexport function parseTemplate(template, delimiters) {\n  var tokens\n  let length = template.length\n  let index = 0\n  let lastIndex = 0\n  let open = delimiters[0], close = delimiters[1]\n\n  while (lastIndex < length) {\n    index = template.indexOf(open, lastIndex)\n\n    if (index < 0) {\n      if (tokens) {\n        tokens.push({\n          type: TEXT,\n          value: template.slice(lastIndex)\n        })\n      }\n\n      break\n    } else {\n      tokens || (tokens = [])\n      if (index > 0 && lastIndex < index) {\n        tokens.push({\n          type: TEXT,\n          value: template.slice(lastIndex, index)\n        })\n      }\n\n      lastIndex = index + open.length\n      index = template.indexOf(close, lastIndex)\n\n      if (index < 0) {\n        let substring = template.slice(lastIndex - close.length)\n        let lastToken = tokens[tokens.length - 1]\n\n        if (lastToken && lastToken.type === TEXT) {\n          lastToken.value += substring\n        } else {\n          tokens.push({\n            type: TEXT,\n            value: substring\n          })\n        }\n\n        break\n      }\n\n      let value = template.slice(lastIndex, index).trim()\n\n      tokens.push({\n        type: BINDING,\n        value: value\n      })\n\n      lastIndex = index + close.length\n    }\n  }\n\n  return tokens\n}\n","import {EXTENSIONS} from './constants'\nimport {parseTemplate, parseType} from './parsers'\n\nconst tinybind = {\n  // Global binders.\n  binders: {},\n\n  // Global formatters.\n  formatters: {},\n\n  // Global sightglass adapters.\n  adapters: {},\n\n  // Default attribute prefix.\n  _prefix: 'rv',\n\n  _fullPrefix: 'rv-',\n\n  get prefix () {\n    return this._prefix\n  },\n\n  set prefix (value) {\n    this._prefix = value\n    this._fullPrefix = value + '-'\n  },\n\n  parseTemplate: parseTemplate,\n\n  parseType: parseType,\n\n  // Default template delimiters.\n  templateDelimiters: ['{', '}'],\n\n  // Default sightglass root interface.\n  rootInterface: '.',\n\n  // Preload data by default.\n  preloadData: true,\n\n  // Default event handler.\n  handler: function(context, ev, binding) {\n    this.call(context, ev, binding.view.models)\n  },\n\n  // Sets the attribute on the element. If no binder above is matched it will fall\n  // back to using this binder.\n  fallbackBinder: function(el, value) {\n    if (value != null) {\n      el.setAttribute(this.type, value)\n    } else {\n      el.removeAttribute(this.type)\n    }  \n  },\n\n  // Merges an object literal into the corresponding global options.\n  configure: function(options) {\n    if (!options) {\n      return\n    }\n    Object.keys(options).forEach(option => {\n      let value = options[option]\n\n      if (EXTENSIONS.indexOf(option) > -1) {\n        Object.keys(value).forEach(key => {\n          this[option][key] = value[key]\n        })\n      } else {\n        this[option] = value\n      }\n    })\n  }\n}\n\nexport default tinybind\n","\n// Check if a value is an object than can be observed.\nfunction isObject(obj) {\n  return typeof obj === 'object' && obj !== null\n}\n\n// Error thrower.\nfunction error(message) {\n  throw new Error(`[Observer] ${message}`)\n}\n\nlet adapters;\nlet interfaces;\nlet rootInterface;\n\n// Constructs a new keypath observer and kicks things off.\nclass Observer {\n  static updateOptions (options) {\n    adapters = options.adapters\n    interfaces = Object.keys(adapters)\n    rootInterface = options.rootInterface\n  }\n  \n  // Tokenizes the provided keypath string into interface + path tokens for the\n  // observer to work with.\n  static tokenize (keypath, root) {\n    const tokens = [];\n    let current = {i: root, path: ''};\n    let index;\n    let chr;\n  \n    for (index = 0; index < keypath.length; index++) {\n      chr = keypath.charAt(index)\n  \n      if (!!~interfaces.indexOf(chr)) {\n        tokens.push(current)\n        current = {i: chr, path: ''}\n      } else {\n        current.path += chr\n      }\n    }\n  \n    tokens.push(current)\n    return tokens\n  }\n\n  constructor(obj, keypath, callback) {\n    this.keypath = keypath\n    this.callback = callback\n    this.objectPath = []\n    this.parse()\n    this.obj = this.getRootObject(obj)\n\n    if (isObject(this.target = this.realize())) {\n      this.set(true, this.key, this.target, this.callback)\n    }\n  }\n\n  // Parses the keypath using the interfaces defined on the view. Sets variables\n  // for the tokenized keypath as well as the end key.\n  parse() {\n    let path;\n    let root;\n\n    if (!interfaces.length) {\n      error('Must define at least one adapter interface.')\n    }\n\n    if (!!~interfaces.indexOf(this.keypath[0])) {\n      root = this.keypath[0]\n      path = this.keypath.substr(1)\n    } else {\n      root = rootInterface\n      path = this.keypath\n    }\n\n    this.tokens = Observer.tokenize(path, root)\n    this.key = this.tokens.pop()\n  }\n\n  // Realizes the full keypath, attaching observers for every key and correcting\n  // old observers to any changed objects in the keypath.\n  realize() {\n    let current = this.obj;\n    let unreached = -1;\n    let prev;\n    let token;\n\n    for (let index = 0; index < this.tokens.length; index++) {\n      token = this.tokens[index]\n      if (isObject(current)) {\n        if (typeof this.objectPath[index] !== 'undefined') {\n          if (current !== (prev = this.objectPath[index])) {\n            this.set(false, token, prev, this)\n            this.set(true, token, current, this)\n            this.objectPath[index] = current\n          }\n        } else {\n          this.set(true, token, current, this)\n          this.objectPath[index] = current\n        }\n\n        current = this.get(token, current)\n      } else {\n        if (unreached === -1) {\n          unreached = index\n        }\n\n        if (prev = this.objectPath[index]) {\n          this.set(false, token, prev, this)\n        }\n      }\n    }\n\n    if (unreached !== -1) {\n      this.objectPath.splice(unreached)\n    }\n\n    return current\n  }\n\n  // Updates the keypath. This is called when any intermediary key is changed.\n  sync() {\n    let next;\n    let oldValue;\n    let newValue;\n\n    if ((next = this.realize()) !== this.target) {\n      if (isObject(this.target)) {\n        this.set(false, this.key, this.target, this.callback)\n      }\n\n      if (isObject(next)) {\n        this.set(true, this.key, next, this.callback)\n      }\n\n      oldValue = this.value()\n      this.target = next\n      newValue = this.value()\n      if (newValue !== oldValue || newValue instanceof Function) this.callback.sync()\n    } else if (next instanceof Array) {\n      this.callback.sync()\n    }\n  }\n\n  // Reads the current end value of the observed keypath. Returns undefined if\n  // the full keypath is unreachable.\n  value() {\n    if (isObject(this.target)) {\n      return this.get(this.key, this.target)\n    }\n  }\n\n  // Sets the current end value of the observed keypath. Calling setValue when\n  // the full keypath is unreachable is a no-op.\n  setValue(value) {\n    if (isObject(this.target)) {\n      adapters[this.key.i].set(this.target, this.key.path, value)\n    }\n  }\n\n  // Gets the provided key on an object.\n  get(key, obj) {\n    return adapters[key.i].get(obj, key.path);\n  }\n\n  // Observes or unobserves a callback on the object using the provided key.\n  set(active, key, obj, callback) {\n    const action = active ? 'observe' : 'unobserve';\n    adapters[key.i][action](obj, key.path, callback)\n  }\n\n  // Unobserves the entire keypath.\n  unobserve() {\n    let obj;\n    let token;\n\n    for (let index = 0; index < this.tokens.length; index++) {\n      token = this.tokens[index]\n      if (obj = this.objectPath[index]) {\n        this.set(false, token, obj, this)\n      }\n    }\n\n    if (isObject(this.target)) {\n      this.set(false, this.key, this.target, this.callback)\n    }\n  }\n\n  // traverse the scope chain to find the scope which has the root property\n  // if the property is not found in chain, returns the root scope\n  getRootObject(obj) {\n    let rootProp;\n    let current;\n    if (!obj.$parent) {\n      return obj;\n    }\n\n    if (this.tokens.length) {\n      rootProp = this.tokens[0].path\n    } else {\n      rootProp = this.key.path\n    }\n\n    current = obj;\n    while (current.$parent && (current[rootProp] === undefined)) {\n      current = current.$parent\n    }\n\n    return current;\n  }\n}\n\nexport default Observer\n","import { parseType } from './parsers'\nimport Observer from './observer'\n\nfunction getInputValue(el) {\n  if (el.type === 'checkbox') {\n    return el.checked\n  } else if (el.type === 'select-multiple') {\n    const results = []\n    let option\n    for (let i = 0; i < el.options.length; i++) {\n      option = el.options[i]\n      if (option.selected) {\n        results.push(option.value);\n      }\n    }\n    return results\n  } else {\n    return el.value\n  }\n}\n\nconst FORMATTER_ARGS = /[^\\s']+|'([^']|'[^\\s])*'|\"([^\"]|\"[^\\s])*\"/g\nconst FORMATTER_SPLIT = /\\s+/\n\n// A single binding between a model attribute and a DOM element.\nexport class Binding {\n  // All information about the binding is passed into the constructor; the\n  // containing view, the DOM node, the type of binding, the model object and the\n  // keypath at which to listen for changes.\n  constructor(view, el, type, keypath, binder, arg, formatters) {\n    this.view = view\n    this.el = el\n    this.type = type\n    this.keypath = keypath\n    this.binder = binder\n    this.arg = arg\n    this.formatters = formatters\n    this.formatterObservers = {}\n    this.model = undefined\n  }\n\n  // Observes the object keypath\n  observe(obj, keypath) {\n    return new Observer(obj, keypath, this)\n  }\n\n  parseTarget() {\n    if (this.keypath) {\n      let token = parseType(this.keypath)\n      if (token.type === 0) {\n        this.value = token.value\n      } else {\n        this.observer = this.observe(this.view.models, this.keypath)\n        this.model = this.observer.target\n      }\n    } else {\n      this.value = undefined;\n    }\n  }\n\n  parseFormatterArguments(args, formatterIndex) {\n    return args\n      .map(parseType)\n      .map(({ type, value }, ai) => {\n        if (type === 0) {\n          return value\n        } else {\n          if (!this.formatterObservers[formatterIndex]) {\n            this.formatterObservers[formatterIndex] = {}\n          }\n\n          let observer = this.formatterObservers[formatterIndex][ai]\n\n          if (!observer) {\n            observer = this.observe(this.view.models, value)\n            this.formatterObservers[formatterIndex][ai] = observer\n          }\n\n          return observer.value()\n        }\n      })\n  }\n\n  // Applies all the current formatters to the supplied value and returns the\n  // formatted value.\n  formattedValue(value) {\n    return this.formatters.reduce((result, declaration, index) => {\n      let args = declaration.match(FORMATTER_ARGS)\n      let id = args.shift()\n      let formatter = this.view.options.formatters[id]\n\n      const processedArgs = this.parseFormatterArguments(args, index)\n\n      if (formatter && (formatter.read instanceof Function)) {\n        result = formatter.read(result, ...processedArgs)\n      } else if (formatter instanceof Function) {\n        result = formatter(result, ...processedArgs)\n      }\n      return result\n    }, value)\n  }\n\n  // Returns an event handler for the binding around the supplied function.\n  eventHandler(fn) {\n    let binding = this\n    let handler = binding.view.options.handler\n\n    return function (ev) {\n      handler.call(fn, this, ev, binding)\n    }\n  }\n\n  // Sets the value for the binding. This Basically just runs the binding routine\n  // with the supplied value formatted.\n  set(value) {\n    if ((value instanceof Function) && !this.binder.function) {\n      value = this.formattedValue(value.call(this.model))\n    } else {\n      value = this.formattedValue(value)\n    }\n\n    let routineFn = this.binder.routine || this.binder\n\n    if (routineFn instanceof Function) {\n      routineFn.call(this, this.el, value)\n    }\n  }\n\n  // Syncs up the view binding with the model.\n  sync() {\n    if (this.observer) {\n      this.model = this.observer.target\n      this.set(this.observer.value())\n    } else {\n      this.set(this.value)\n    }\n  }\n\n  // Publishes the value currently set on the input element back to the model.\n  publish() {\n    if (this.observer) {\n      var value = this.formatters.reduceRight((result, declaration, index) => {\n        const args = declaration.split(FORMATTER_SPLIT)\n        const id = args.shift()\n        const formatter = this.view.options.formatters[id]\n        const processedArgs = this.parseFormatterArguments(args, index)\n\n        if (formatter && formatter.publish) {\n          result = formatter.publish(result, ...processedArgs)\n        }\n        return result\n      }, this.getValue(this.el))\n      this.observer.setValue(value)\n    }\n  }\n\n  // Subscribes to the model for changes at the specified keypath. Bi-directional\n  // routines will also listen for changes on the element to propagate them back\n  // to the model.\n  bind() {\n    this.parseTarget()\n\n    if (this.binder.hasOwnProperty('bind')) {\n      this.binder.bind.call(this, this.el)\n    }\n\n    if (this.view.options.preloadData) {\n      this.sync()\n    }\n  }\n\n  // Unsubscribes from the model and the element.\n  unbind() {\n    if (this.binder.unbind) {\n      this.binder.unbind.call(this, this.el)\n    }\n\n    if (this.observer) {\n      this.observer.unobserve()\n    }\n\n    Object.keys(this.formatterObservers).forEach(fi => {\n      let args = this.formatterObservers[fi]\n\n      Object.keys(args).forEach(ai => {\n        args[ai].unobserve()\n      })\n    })\n\n    this.formatterObservers = {}\n  }\n\n  // Updates the binding's model from what is currently set on the view. Unbinds\n  // the old model first and then re-binds with the new model.\n  update(models = {}) {\n    if (this.observer) {\n      this.model = this.observer.target\n    }\n\n    if (this.binder.update) {\n      this.binder.update.call(this, models)\n    }\n  }\n\n  // Returns elements value\n  getValue(el) {\n    if (this.binder && this.binder.getValue) {\n      return this.binder.getValue.call(this, el)\n    } else {\n      return getInputValue(el)\n    }\n  }\n}\n","import tinybind from './tinybind'\nimport {Binding} from './bindings'\nimport {parseTemplate} from './parsers'\n\nconst textBinder = {\n  routine: (node, value) => {\n    node.data = (value != null) ? value : ''\n  }\n}\n\nconst DECLARATION_SPLIT = /((?:'[^']*')*(?:(?:[^\\|']*(?:'[^']*')+[^\\|']*)+|[^\\|]+))|^$/g\n\nconst parseNode = (view, node) => {\n  let block = false\n\n  if (node.nodeType === 3) {\n    let tokens = parseTemplate(node.data, tinybind.templateDelimiters)\n\n    if (tokens) {\n      for (let i = 0; i < tokens.length; i++) {\n        let token = tokens[i]\n        let text = document.createTextNode(token.value)\n        node.parentNode.insertBefore(text, node)\n\n        if (token.type === 1) {\n          view.buildBinding(text, null, token.value, textBinder, null)\n        }\n      }\n\n      node.parentNode.removeChild(node)\n    }\n    block = true\n  } else if (node.nodeType === 1) {\n    block = view.traverse(node)\n  }\n\n  if (!block) {\n    for (let i = 0; i < node.childNodes.length; i++) {\n      parseNode(view, node.childNodes[i]);\n    }\n  }\n}\n\nconst bindingComparator = (a, b) => {\n  let aPriority = a.binder ? (a.binder.priority || 0) : 0\n  let bPriority = b.binder ? (b.binder.priority || 0) : 0\n  return bPriority - aPriority\n}\n\nconst trimStr = (str) => {\n  return str.trim()\n}\n\n// A collection of bindings built from a set of parent nodes.\nexport default class View {\n  // The DOM elements and the model objects for binding are passed into the\n  // constructor along with any local options that should be used throughout the\n  // context of the view and it's bindings.\n  constructor(els, models, options) {\n    if (els.jquery || els instanceof Array) {\n      this.els = els\n    } else {\n      this.els = [els]\n    }\n\n    this.models = models\n    this.options = options\n\n    this.build()\n  }\n\n\n  buildBinding(node, type, declaration, binder, arg) {\n    let pipes = declaration.match(DECLARATION_SPLIT).map(trimStr)\n\n    let keypath = pipes.shift()\n\n    this.bindings.push(new Binding(this, node, type, keypath, binder, arg, pipes))\n  }\n\n  // Parses the DOM tree and builds `Binding` instances for every matched\n  // binding declaration.\n  build() {\n    this.bindings = []\n\n    let elements = this.els, i, len;\n    for (i = 0, len = elements.length; i < len; i++) {\n      parseNode(this, elements[i])\n    }\n\n    this.bindings.sort(bindingComparator)\n  }\n\n  traverse(node) {\n    let bindingPrefix = tinybind._fullPrefix\n    let block = node.nodeName === 'SCRIPT' || node.nodeName === 'STYLE'\n    let attributes = node.attributes\n    let bindInfos = []\n    let starBinders = this.options.starBinders\n    var type, binder, identifier, arg\n\n\n    for (let i = 0, len = attributes.length; i < len; i++) {\n      let attribute = attributes[i]\n      if (attribute.name.indexOf(bindingPrefix) === 0) {\n        type = attribute.name.slice(bindingPrefix.length)\n        binder = this.options.binders[type]\n        arg = undefined\n\n        if (!binder) {\n          for (let k = 0; k < starBinders.length; k++) {\n            identifier = starBinders[k]\n            if (type.slice(0, identifier.length - 1) === identifier.slice(0, -1)) {\n              binder = this.options.binders[identifier]\n              arg = type.slice(identifier.length - 1)\n              break\n            }\n          }\n        }\n\n        if (!binder) {\n          binder = tinybind.fallbackBinder\n        }\n\n        if (binder.block) {\n          this.buildBinding(node, type, attribute.value, binder, arg)\n          node.removeAttribute(attribute.name)\n          return true;\n        }\n\n        bindInfos.push({attr: attribute, binder: binder, type: type, arg: arg})\n      }\n    }\n\n    for (let i = 0; i < bindInfos.length; i++) {\n      let bindInfo = bindInfos[i]\n      this.buildBinding(node, bindInfo.type, bindInfo.attr.value, bindInfo.binder, bindInfo.arg)\n      node.removeAttribute(bindInfo.attr.name)\n    }\n\n    return block\n  }\n\n  // Binds all of the current bindings for this view.\n  bind() {\n    this.bindings.forEach(binding => {\n      binding.bind()\n    })\n  }\n\n  // Unbinds all of the current bindings for this view.\n  unbind() {\n    this.bindings.forEach(binding => {\n      binding.unbind()\n    })\n  }\n\n  // Syncs up the view with the model by running the routines on all bindings.\n  sync() {\n    this.bindings.forEach(binding => {\n      binding.sync()\n    })\n  }\n\n  // Publishes the input values from the view back to the model (reverse sync).\n  publish() {\n    this.bindings.forEach(binding => {\n      if (binding.binder && binding.binder.publishes) {\n        binding.publish()\n      }\n    })\n  }\n\n  // Updates the view's models along with any affected bindings.\n  update(models = {}) {\n    Object.keys(models).forEach(key => {\n      this.models[key] = models[key]\n    })\n\n    this.bindings.forEach(binding => {\n      if (binding.update) {\n        binding.update(models)\n      }\n    })\n  }\n}\n","// The default `.` adapter that comes with tinybind.js. Allows subscribing to\n// properties on plain objects, implemented in ES5 natives using\n// `Object.defineProperty`.\n\nconst ARRAY_METHODS = [\n  'push',\n  'pop',\n  'shift',\n  'unshift',\n  'sort',\n  'reverse',\n  'splice'\n]\n\nconst adapter = {\n  counter: 0,\n  weakmap: {},\n\n  weakReference: function(obj) {\n    if (!obj.hasOwnProperty('__rv')) {\n      let id = this.counter++\n\n      Object.defineProperty(obj, '__rv', {\n        value: id\n      })\n    }\n\n    if (!this.weakmap[obj.__rv]) {\n      this.weakmap[obj.__rv] = {\n        callbacks: {}\n      }\n    }\n\n    return this.weakmap[obj.__rv]\n  },\n\n  cleanupWeakReference: function(data, refId) {\n    if (!Object.keys(data.callbacks).length) {\n      if (!(data.pointers && Object.keys(data.pointers).length)) {\n        delete this.weakmap[refId]\n      }\n    }\n  },\n\n  stubFunction: function(obj, fn) {\n    const original = obj[fn]\n    const data = this.weakReference(obj)\n    const weakmap = this.weakmap\n\n    obj[fn] = (...args) => {\n      let response = original.apply(obj, args)\n\n      Object.keys(data.pointers).forEach(refId => {\n        let k = data.pointers[refId]\n\n        if (weakmap[refId]) {\n          if (weakmap[refId].callbacks[k] instanceof Array) {\n            weakmap[refId].callbacks[k].forEach(callback => {\n              callback.sync()\n            })\n          }\n        }\n      })\n\n      return response\n    }\n  },\n\n  observeArray: function(value, refId, keypath) {\n    if (value instanceof Array) {\n      let data = this.weakReference(value)\n\n      if (!data.pointers) {\n        data.pointers = {}\n\n        ARRAY_METHODS.forEach(fn => {\n          this.stubFunction(value, fn)\n        })\n      }\n\n      if (!data.pointers[refId]) {\n        data.pointers[refId] = []\n      }\n\n      if (data.pointers[refId].indexOf(keypath) === -1) {\n        data.pointers[refId].push(keypath)\n      }\n    }\n  },\n\n  unobserveArray: function(value, refId, keypath) {\n    if ((value instanceof Array) && (value.__rv != null)) {\n      let data = this.weakmap[value.__rv]\n\n      if (data) {\n        let pointers = data.pointers[refId]\n\n        if (pointers) {\n          let idx = pointers.indexOf(keypath)\n\n          if (idx > -1) {\n            pointers.splice(idx, 1)\n          }\n\n          if (!pointers.length) {\n            delete data.pointers[refId]\n          }\n\n          this.cleanupWeakReference(data, value.__rv)\n        }\n      }\n    }\n  },\n\n  observe: function(obj, keypath, callback) {\n    let value    \n    const callbacks = this.weakReference(obj).callbacks\n\n    if (!callbacks[keypath]) {\n      callbacks[keypath] = []\n      let desc = Object.getOwnPropertyDescriptor(obj, keypath)\n\n      if (!desc || !(desc.get || desc.set || !desc.configurable)) {\n        value = obj[keypath]\n\n        Object.defineProperty(obj, keypath, {\n          enumerable: true,\n\n          get: () => {\n            return value\n          },\n\n          set: newValue => {\n            if (newValue !== value) {\n              this.unobserveArray(value, obj.__rv, keypath)\n              value = newValue\n              const data = this.weakmap[obj.__rv]\n\n              if (data) {\n                let callbacks = data.callbacks[keypath]\n\n                if (callbacks) {\n                  callbacks.forEach(cb => {\n                      cb.sync()\n                  })\n                }\n\n                this.observeArray(newValue, obj.__rv, keypath)\n              }\n            }\n          }\n        })\n      }\n    }\n\n    if (callbacks[keypath].indexOf(callback) === -1) {\n      callbacks[keypath].push(callback)\n    }\n\n    this.observeArray(obj[keypath], obj.__rv, keypath)\n  },\n\n  unobserve: function(obj, keypath, callback) {\n    let data = this.weakmap[obj.__rv]\n\n    if (data) {\n      let callbacks = data.callbacks[keypath]\n\n      if (callbacks) {\n        let idx = callbacks.indexOf(callback)\n\n        if (idx > -1) {\n          callbacks.splice(idx, 1)\n\n          if (!callbacks.length) {\n            delete data.callbacks[keypath]\n            this.unobserveArray(obj[keypath], obj.__rv, keypath)\n          }\n        }\n\n        this.cleanupWeakReference(data, obj.__rv)\n      }\n    }\n  },\n\n  get: function(obj, keypath) {\n    return obj[keypath]\n  },\n\n  set: (obj, keypath, value) => {\n    obj[keypath] = value\n  }\n}\n\nexport default adapter\n","import View from './view'\n\nconst getString = (value) => {\n  return value != null ? value.toString() : undefined\n}\n\nconst times = (n, cb) => {\n  for (let i = 0; i < n; i++) cb()\n}\n\nfunction createView(binding, data, anchorEl) {\n  let template = binding.el.cloneNode(true)\n  let view = new View(template, data, binding.view.options)\n  view.bind()\n  binding.marker.parentNode.insertBefore(template, anchorEl)\n  return view\n}\n\nconst binders = {\n  // Binds an event handler on the element.\n  'on-*': {\n    function: true,\n    priority: 1000,\n\n    unbind: function(el) {\n      if (this.handler) {\n        el.removeEventListener(this.arg, this.handler)\n      }\n    },\n\n    routine: function(el, value) {\n      if (this.handler) {\n        el.removeEventListener(this.arg, this.handler)\n      }\n\n      this.handler = this.eventHandler(value)\n      el.addEventListener(this.arg, this.handler)\n    }\n  },\n\n  // Appends bound instances of the element in place for each item in the array.\n  'each-*': {\n    block: true,\n\n    priority: 4000,\n\n    bind: function(el) {\n      if (!this.marker) {\n        this.marker = document.createComment(` tinybind: ${this.type} `)\n        this.iterated = []\n\n        el.parentNode.insertBefore(this.marker, el)\n        el.parentNode.removeChild(el)\n      } else {\n        this.iterated.forEach(view => {\n          view.bind()\n        })\n      }\n    },\n\n    unbind: function(el) {\n      if (this.iterated) {\n        this.iterated.forEach(view => {\n          view.unbind()\n        })\n      }\n    },\n\n    routine: function(el, collection) {\n      let modelName = this.arg\n      collection = collection || []\n      let indexProp = el.getAttribute('index-property') || '$index'\n\n      collection.forEach((model, index) => {\n        let data = {$parent: this.view.models}\n        data[indexProp] = index\n        data[modelName] = model\n        let view = this.iterated[index]\n\n        if (!view) {\n\n          let previous = this.marker\n\n          if (this.iterated.length) {\n            previous = this.iterated[this.iterated.length - 1].els[0]\n          }\n\n          view = createView(this, data, previous.nextSibling)\n          this.iterated.push(view)\n        } else {\n          if (view.models[modelName] !== model) {\n            // search for a view that matches the model\n            let matchIndex, nextView\n            for (let nextIndex = index + 1; nextIndex < this.iterated.length; nextIndex++) {\n              nextView = this.iterated[nextIndex]\n              if (nextView.models[modelName] === model) {\n                matchIndex = nextIndex\n                break\n              }\n            }\n            if (matchIndex !== undefined) {\n              // model is in other position\n              // todo: consider avoiding the splice here by setting a flag\n              // profile performance before implementing such change\n              this.iterated.splice(matchIndex, 1)\n              this.marker.parentNode.insertBefore(nextView.els[0], view.els[0])\n              nextView.models[indexProp] = index\n            } else {\n              //new model\n              nextView = createView(this, data, view.els[0])\n            }\n            this.iterated.splice(index, 0, nextView)\n          } else {\n            view.models[indexProp] = index\n          }\n        }\n      })\n\n      if (this.iterated.length > collection.length) {\n        times(this.iterated.length - collection.length, () => {\n          let view = this.iterated.pop()\n          view.unbind()\n          this.marker.parentNode.removeChild(view.els[0])\n        })\n      }\n\n      if (el.nodeName === 'OPTION') {\n        this.view.bindings.forEach(binding => {\n          if (binding.el === this.marker.parentNode && binding.type === 'value') {\n            binding.sync()\n          }\n        })\n      }\n    },\n\n    update: function(models) {\n      let data = {}\n\n      //todo: add test and fix if necessary\n\n      Object.keys(models).forEach(key => {\n        if (key !== this.arg) {\n          data[key] = models[key]\n        }\n      })\n\n      this.iterated.forEach(view => {\n        view.update(data)\n      })\n    }\n  },\n\n  // Adds or removes the class from the element when value is true or false.\n  'class-*': function(el, value) {\n    let elClass = ` ${el.className} `\n\n    if (!value === (elClass.indexOf(` ${this.arg} `) > -1)) {\n      if (value) {\n        el.className = `${el.className} ${this.arg}`\n      } else {\n        el.className = elClass.replace(` ${this.arg} `, ' ').trim()\n      }\n    }\n  },\n\n  // Sets the element's text value.\n  text: (el, value) => {\n    el.textContent = value != null ? value : ''\n  },\n\n  // Sets the element's HTML content.\n  html: (el, value) => {\n    el.innerHTML = value != null ? value : ''\n  },\n\n  // Shows the element when value is true.\n  show: (el, value) => {\n    el.style.display = value ? '' : 'none'\n  },\n\n  // Hides the element when value is true (negated version of `show` binder).\n  hide: (el, value) => {\n    el.style.display = value ? 'none' : ''\n  },\n\n  // Enables the element when value is true.\n  enabled: (el, value) => {\n    el.disabled = !value\n  },\n\n  // Disables the element when value is true (negated version of `enabled` binder).\n  disabled: (el, value) => {\n    el.disabled = !!value\n  },\n\n  // Checks a checkbox or radio input when the value is true. Also sets the model\n  // property when the input is checked or unchecked (two-way binder).\n  checked: {\n    publishes: true,\n    priority: 2000,\n\n    bind: function(el) {\n      var self = this;\n      if (!this.callback) {\n        this.callback = function () {\n          self.publish();\n        }\n      }\n      el.addEventListener('change', this.callback)\n    }, \n\n    unbind: function(el) {\n      el.removeEventListener('change', this.callback)\n    },\n\n    routine: function(el, value) {\n      if (el.type === 'radio') {\n        el.checked = getString(el.value) === getString(value)\n      } else {\n        el.checked = !!value\n      }\n    }\n  },\n\n  // Sets the element's value. Also sets the model property when the input changes\n  // (two-way binder).\n  value: {\n    publishes: true,\n    priority: 3000,\n\n    bind: function(el) {\n      this.isRadio = el.tagName === 'INPUT' && (el.type === 'radio' || el.type === 'checkbox');\n      if (!this.isRadio) {\n        this.event = el.getAttribute('event-name') || (el.tagName === 'SELECT' ? 'change' : 'input')\n\n        var self = this;\n        if (!this.callback) {\n          this.callback = function () {\n            self.publish();\n          }\n        }\n        el.addEventListener(this.event, this.callback)\n      }\n    },\n\n    unbind: function(el) {\n      if (!this.isRadio) {\n        el.removeEventListener(this.event, this.callback)\n      }\n    },\n\n    routine: function(el, value) {\n      if (this.isRadio) {\n        el.setAttribute('value', value)\n      } else {\n        if (el.type === 'select-multiple') {\n          if (value instanceof Array) {\n            for (let i = 0; i < el.length; i++) {\n              let option = el[i];\n              option.selected = value.indexOf(option.value) > -1\n            }\n          }\n        } else if (getString(value) !== getString(el.value)) {\n          el.value = value != null ? value : ''\n        }\n      }\n    }\n  },\n\n  // Inserts and binds the element and it's child nodes into the DOM when true.\n  if: {\n    block: true,\n    priority: 4000,\n\n    bind: function(el) {\n      if (!this.marker) {\n        this.marker = document.createComment(' tinybind: ' + this.type + ' ' + this.keypath + ' ');\n        this.attached = false\n\n        el.parentNode.insertBefore(this.marker, el)\n        el.parentNode.removeChild(el)\n      } else if (this.bound === false && this.nested) {\n        this.nested.bind()\n      }\n      this.bound = true\n    },\n\n    unbind: function() {\n      if (this.nested) {\n        this.nested.unbind()\n        this.bound = false\n      }\n    },\n\n    routine: function(el, value) {\n      if (!!value !== this.attached) {\n        if (value) {\n\n          if (!this.nested) {\n            this.nested = new View(el, this.view.models, this.view.options)\n            this.nested.bind()\n          }\n\n          this.marker.parentNode.insertBefore(el, this.marker.nextSibling)\n          this.attached = true\n        } else {\n          el.parentNode.removeChild(el)\n          this.attached = false\n        }\n      }\n    },\n\n    update: function(models) {\n      if (this.nested) {\n        this.nested.update(models)\n      }\n    }\n  }\n}\n\nexport default binders\n","const formatters = {\n  watch: function(value) {\n    return value;\n  },\n\n  not: function(value) {\n    return !value;\n  },\n\n  negate: function(value) {\n    return !value;\n  }\n}\n\nexport default formatters","\nimport tinybind from './tinybind'\n\nclass Component extends HTMLElement {\n  static get observedAttributes() {\n    const template = this.template\n    if (!template) {\n      throw new Error(`No template declared for ${this.name}`)\n    }\n\n    this.__templateEl = document.createElement('template')\n    this.__templateEl.innerHTML = template\n    \n    const propAttributeMap = this.__propAttributeMap = {}\n    const attributes = []\n    const properties = this.properties\n    if (properties) {\n      Object.keys(properties).forEach(propName => {\n        const propConfig = properties[propName]\n        const attrName = typeof propConfig === 'string' ? propConfig : propName\n        propAttributeMap[attrName] = propName\n        attributes.push(attrName)\n      })\n    }    \n    return attributes\n  }\n\n  connectedCallback() {\n    const nodes = this.constructor.__templateEl.content.cloneNode(true)\n    this.__tinybindView = tinybind.bind(nodes, this)    \n    while (this.firstChild) {\n      this.removeChild(this.firstChild);\n    }\n    this.appendChild(nodes)\n  }\n\n  disconnectedCallback() {\n    this.__tinybindView.unbind()    \n  }\n\n  attributeChangedCallback(name, old, value) {\n    if (old !== value) {      \n      const propName = this.constructor.__propAttributeMap[name]\n      this[propName] = value\n    }\n  }  \n}\n\nexport default Component","import tinybind from './tinybind'\nimport View from './view'\nimport {OPTIONS, EXTENSIONS} from './constants'\nimport adapter from './adapter'\nimport binders from './binders'\nimport formatters from './formatters'\nimport Observer from './observer'\nimport Component from './component'\n\n// Returns the public interface.\n\ntinybind.binders = binders\ntinybind.formatters = formatters\ntinybind.adapters['.'] = adapter\ntinybind.Component = Component\n\n// Binds some data to a template / element. Returns a tinybind.View instance.\ntinybind.bind = (el, models, options) => {\n  let viewOptions = {}\n  models = models || {}\n  options = options || {}\n\n  EXTENSIONS.forEach(extensionType => {\n    viewOptions[extensionType] = Object.create(null)\n\n    if (options[extensionType]) {\n      Object.keys(options[extensionType]).forEach(key => {\n        viewOptions[extensionType][key] = options[extensionType][key]\n      })\n    }\n\n    Object.keys(tinybind[extensionType]).forEach(key => {\n      if (!viewOptions[extensionType][key]) {\n        viewOptions[extensionType][key] = tinybind[extensionType][key]\n      }\n    })\n  })\n\n  OPTIONS.forEach(option => {\n    let value = options[option]\n    viewOptions[option] = value != null ? value : tinybind[option]\n  })\n\n  viewOptions.starBinders = Object.keys(viewOptions.binders).filter(function (key) {\n    return key.indexOf('*') > 0\n  })\n\n  Observer.updateOptions(viewOptions)\n\n  let view = new View(el, models, viewOptions)\n  view.bind()\n  return view\n}\n\nexport default tinybind\n"],"names":["OPTIONS","EXTENSIONS","PRIMITIVE","KEYPATH","TEXT","BINDING","QUOTED_STR","parseType","string","type","value","test","slice","undefined","isNaN","Number","parseTemplate","template","delimiters","tokens","length","index","lastIndex","open","close","indexOf","push","substring","lastToken","trim","tinybind","binders","formatters","adapters","_prefix","_fullPrefix","prefix","templateDelimiters","rootInterface","preloadData","handler","context","ev","binding","call","view","models","fallbackBinder","el","setAttribute","removeAttribute","configure","options","Object","keys","forEach","option","key","isObject","obj","error","message","Error","interfaces","Observer","updateOptions","tokenize","keypath","root","current","i","path","chr","charAt","callback","objectPath","parse","getRootObject","target","realize","set","substr","pop","unreached","prev","token","get","splice","sync","next","oldValue","newValue","Function","Array","setValue","active","action","unobserve","rootProp","$parent","getInputValue","checked","results","selected","FORMATTER_ARGS","FORMATTER_SPLIT","Binding","binder","arg","formatterObservers","model","observe","parseTarget","observer","parseFormatterArguments","args","formatterIndex","map","ai","formattedValue","reduce","result","declaration","match","id","shift","formatter","processedArgs","read","eventHandler","fn","function","routineFn","routine","publish","reduceRight","split","getValue","bind","hasOwnProperty","unbind","fi","update","textBinder","node","data","DECLARATION_SPLIT","parseNode","block","nodeType","text","document","createTextNode","parentNode","insertBefore","buildBinding","removeChild","traverse","childNodes","bindingComparator","a","b","aPriority","priority","bPriority","trimStr","str","View","els","jquery","build","pipes","bindings","elements","len","sort","bindingPrefix","nodeName","attributes","bindInfos","starBinders","identifier","attribute","name","k","attr","bindInfo","publishes","ARRAY_METHODS","adapter","counter","weakmap","weakReference","defineProperty","__rv","callbacks","cleanupWeakReference","refId","pointers","stubFunction","original","response","apply","observeArray","unobserveArray","idx","desc","getOwnPropertyDescriptor","configurable","enumerable","cb","getString","toString","times","n","createView","anchorEl","cloneNode","marker","removeEventListener","addEventListener","createComment","iterated","collection","modelName","indexProp","getAttribute","previous","nextSibling","matchIndex","nextView","nextIndex","elClass","className","replace","textContent","html","innerHTML","show","style","display","hide","enabled","disabled","self","isRadio","tagName","event","if","attached","bound","nested","watch","not","negate","Component","connectedCallback","nodes","constructor","__templateEl","content","__tinybindView","firstChild","appendChild","disconnectedCallback","attributeChangedCallback","old","propName","__propAttributeMap","createElement","propAttributeMap","properties","propConfig","attrName","HTMLElement","viewOptions","extensionType","create","filter"],"mappings":"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"}